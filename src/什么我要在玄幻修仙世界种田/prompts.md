# 状态栏生成指南 (v2.0)

请根据最新的情节发展，更新并生成状态栏。状态栏是对当前情节的一次信息总结，并为玩家提供合理的行动选项。

**核心原则**: 
1.  **增量更新**: 您的JSON输出应尽可能简洁，只关注**增量变化**。前端脚本会自动处理数据的合并、计算和持久化。
2.  **拟人化交互**: 系统（如成就、签到、以物换物等）是拟人化的存在。当触发系统事件时，请在**正文叙事**中生动地描写系统与角色之间的交互，而不仅仅是在JSON中更新数据。例如，签到时，可以在正文中写道：“【签到系统】在你脑海中懒洋洋地打了个哈欠：‘今天也来了啊，给你这个，拿去吧。’”

**基本结构**:
状态栏JSON必须被包裹在 `<statusbar>` 和 `</statusbar>` 标签内。

```json
<statusbar>
{
  "状态总览": {
    // ... 核心数据 ...
  }
}
</statusbar>
```

---

## 一、 核心数据更新

这些是每次都需要提供的基础信息。

-   **`🗓️ 日期与时间`**: 更新当前的游戏时间。
-   **`🏞️ 地点与环境`**: 更新玩家当前所处的地点。
-   **`角色列表`**: 更新角色的核心状态，特别是**当前持有**的`核心物品`。
-   **`庇护所` / `妖兽图鉴` / `植物图鉴` / `物品图鉴`**: 更新这些模块的宏观状态（例如庇护所等级、图鉴发现数量等）。
-   **`行动选项`**: 根据当前情境，提供4-5个合理的行动选项。

---

## 二、 独立事件更新

### 1. 物品图鉴 (新物品发现)

当玩家首次获得或鉴定出新物品时，在 **`状态总览`** 的顶层添加`新物品发现`字段。

-   **`新物品发现`**: 一个对象（或对象数组），应包含物品的详细信息，例如`名称`, `品阶`, `描述`等。

**示例**:
```json
"状态总览": {
  "新物品发现": {
    "名称": "潮汐木芯",
    "品阶": "凡品中阶",
    "描述": "被海水长期冲刷的灵木核心，质地坚硬，防腐防潮。"
  },
  // ... 其他核心数据 ...
}
```

---

## 三、 系统交互与增量更新

这是与前端脚本交互的核心。您**只需**在`系统`对象中提供相应的“事件”字段，前端会自动处理。

### 1. 签到系统

当玩家签到成功时，在`系统`对象中添加以下字段：

-   **`今日已签到`**: `true` (必需)
-   **`奖励`**: (可选) 一个字符串，格式为 `"【物品名称】x数量"`。前端会自动将其添加到玩家物品栏。
-   **`提示`**: (可选) 一段描述签到结果的文字。

**示例**:
```json
"🔄 系统": {
  "名称": "签到系统",
  "今日已签到": true,
  "奖励": "【灵谷种子】x5",
  "提示": "签到成功！连续签到已达5天，额外获得【灵谷种子】x5！"
}
```

### 2. 成就系统

当玩家解锁新成就时，在`系统`对象中添加`新成就`字段。

-   **`新成就`**: 一个对象（或对象数组），必须包含：
    -   `名称`: 成就名。
    -   `描述`: 成就描述。
    -   `点数`: 完成该成就获得的成就点数。
    -   也可以包含`完成时间`、`完成地点`等任意额外描述性字段。

**示例 (单个成就)**:
```json
"🔄 系统": {
  "名称": "成就系统",
  "新成就": {
    "名称": "蟹逅",
    "描述": "第一次击败（或赶跑）礁岩拟蟹。",
    "点数": 10,
    "完成时间": "穿越后第五日·黄昏",
    "完成地点": "东部礁石滩"
  }
}
```

### 3. 技能面板

当玩家技能熟练度提升或学会新技能时，在`系统`对象中添加`技能提升`字段。

-   **`技能提升`**: 一个对象（或对象数组），必须包含：
    -   `名称`: 技能名。
    -   `熟练度增加`: 一个数字。

**示例 (多个技能)**:
```json
"🔄 系统": {
  "名称": "技能面板",
  "技能提升": [
    { "名称": "灵植术", "熟练度增加": 10 },
    { "名称": "钓鱼", "熟练度增加": 20 }
  ]
}
```

### 4. 以物换物系统

当玩家请求交换物品后，在`系统`对象中添加`物品交换`字段。

-   **`物品交换`**: 一个对象，必须包含：
    -   `成功`: `true` 或 `false`。
    -   `提示`: 交易结果的描述文本。
    -   `交换物品`: (仅在成功时需要) 一个对象，包含`获得`和`失去`两个数组。

**示例 (成功)**:
```json
"🔄 系统": {
  "名称": "以物换物系统",
  "物品交换": {
    "成功": true,
    "提示": "交易愉快！",
    "交换物品": {
      "获得": ["【高级鱼竿】x1"],
      "失去": ["【潮汐木芯】x10"]
    }
  }
}
```

**示例 (失败)**:
```json
"🔄 系统": {
  "名称": "以物换物系统",
  "物品交换": {
    "成功": false,
    "提示": "哎呀，真不巧，这东西刚被换走了！"
  }
}
```

### 5. 物品变化 (消耗/获得)

当玩家因制作、消耗、任务等原因失去或获得物品时，在`系统`对象中添加`物品变化`字段。

-   **`物品变化`**: 一个对象，必须包含：
    -   `失去`: (可选) 一个字符串数组，格式为 `["【物品名称】x数量", ...]`。
    -   `获得`: (可选) 一个字符串数组，格式为 `["【物品名称】x数量", ...]`。
    -   `提示`: (必需) 一段描述物品变化的文字。

**示例 (制作物品)**:
```json
"🔄 系统": {
  "名称": "制作系统",
  "物品变化": {
    "失去": ["【潮汐木芯】x5", "【海淬浮铁】x2"],
    "获得": ["【简易的斧头】x1"],
    "提示": "你消耗了5个潮汐木芯和2个海淬浮铁，成功制作了一把简易的斧头。"
  }
}
```

**示例 (消耗物品)**:
```json
"🔄 系统": {
  "名称": "消耗事件",
  "物品变化": {
    "失去": ["【灵谷】x3"],
    "提示": "你吃掉了3份灵谷，恢复了体力。"
  }
}
```

### 6. 庇护所系统

当庇护所发生变化（如升级、新增功能）时，在`系统`对象中添加`庇护所升级`字段。

-   **`庇护所升级`**: 一个对象，包含所有**发生变化**的属性。前端会自动将这些新属性合并到现有的庇护所数据中。
    -   `名称`: (可选) 新的名称。
    -   `类型`: (可选) 新的等级描述。
    -   `状态`: (可选) 新的状态。
    -   `新增功能`: (可选) 一个字符串或字符串数组，描述新增的功能。
    -   `提示`: (必需) 一段描述变化的文字。

**示例 (庇护所升级)**:
```json
"🔄 系统": {
  "名称": "庇护所",
  "庇护所升级": {
    "类型": "石木混合结构",
    "状态": "稳固",
    "新增功能": "🔨 简易工作台",
    "提示": "经过一番努力，你的庇护所成功升级，现在更加坚固了，并且你拥有了一个简易的工作台！"
  }
}
```

### 7. 刷新机制

当玩家请求刷新（例如刷新可交换物品）时，您**无需**在当前响应中添加特殊字段。只需在**下一条消息**的状态栏JSON中，直接提供更新后的完整列表即可。前端会自动检测变化并更新UI和图鉴。

**示例 (刷新“以物换物”后的下一条消息)**:
```json
"🔄 系统": {
  "名称": "以物换物系统",
  "可换取的物品": [
    { "名称": "破旧的渔网", "描述": "...", "价值": 15, "库存": 1 },
    { "名称": "神秘的海螺", "描述": "...", "价值": 120, "库存": 1 }
  ],
  "提示": "我刚淘到一批新宝贝，看看有没有你中意的？"
}
